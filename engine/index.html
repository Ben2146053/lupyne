
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Pythonic search engine based on PyLucene." name="description"/>
<link href="../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-6.1.6" name="generator"/>
<title>Engine - lupyne</title>
<link href="../assets/stylesheets/main.6910b76c.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.196e0c26.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#analyzers">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="lupyne" class="md-header-nav__button md-logo" href=".." title="lupyne">
<img alt="logo" src="../logo.png"/>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            lupyne
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Engine
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/coady/lupyne" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    coady/lupyne
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="lupyne" class="md-nav__button md-logo" href=".." title="lupyne">
<img alt="logo" src="../logo.png"/>
</a>
    lupyne
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/coady/lupyne" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    coady/lupyne
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
      Introduction
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Engine
        <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
      Engine
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#analyzers">
    analyzers
  </a>
<nav aria-label="analyzers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream">
    TokenStream
  </a>
<nav aria-label="TokenStream" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.charTerm">
    charTerm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.offset">
    offset
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.payload">
    payload
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.positionIncrement">
    positionIncrement
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.type">
    type
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenFilter">
    TokenFilter
  </a>
<nav aria-label="TokenFilter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenFilter.incrementToken">
    incrementToken()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer">
    Analyzer
  </a>
<nav aria-label="Analyzer" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.highlight">
    highlight()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.parse">
    parse()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.standard">
    standard()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.tokens">
    tokens()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.whitespace">
    whitespace()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indexers">
    indexers
  </a>
<nav aria-label="indexers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader">
    IndexReader
  </a>
<nav aria-label="IndexReader" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.directory">
    directory
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.fieldinfos">
    fieldinfos
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.path">
    path
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.readers">
    readers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.segments">
    segments
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.timestamp">
    timestamp
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.copy">
    copy()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.docs">
    docs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.docvalues">
    docvalues()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.morelikethis">
    morelikethis()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.positions">
    positions()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.positionvector">
    positionvector()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.sortfield">
    sortfield()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.suggest">
    suggest()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.terms">
    terms()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.termvector">
    termvector()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher">
    IndexSearcher
  </a>
<nav aria-label="IndexSearcher" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.highlighter">
    highlighter
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.complete">
    complete()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.count">
    count()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.facets">
    facets()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.get">
    get()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.groupby">
    groupby()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.load">
    load()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.match">
    match()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.reopen">
    reopen()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.search">
    search()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.spans">
    spans()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.spellchecker">
    spellchecker()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.MultiSearcher">
    MultiSearcher
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter">
    IndexWriter
  </a>
<nav aria-label="IndexWriter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.__iadd__">
    __iadd__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.add">
    add()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.check">
    check()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.delete">
    delete()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.document">
    document()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.set">
    set()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.snapshot">
    snapshot()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.update">
    update()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.Indexer">
    Indexer
  </a>
<nav aria-label="Indexer" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.Indexer.commit">
    commit()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.Indexer.refresh">
    refresh()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#documents">
    documents
  </a>
<nav aria-label="documents" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document">
    Document
  </a>
<nav aria-label="Document" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document.dict">
    dict()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document.get">
    get()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document.getlist">
    getlist()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hit">
    Hit
  </a>
<nav aria-label="Hit" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hit.dict">
    dict()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits">
    Hits
  </a>
<nav aria-label="Hits" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.maxscore">
    maxscore
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.docvalues">
    docvalues()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.filter">
    filter()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.groupby">
    groupby()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.highlights">
    highlights()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.select">
    select()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.sorted">
    sorted()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Groups">
    Groups
  </a>
<nav aria-label="Groups" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Groups.facets">
    facets
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Groups.select">
    select()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.GroupingSearch">
    GroupingSearch
  </a>
<nav aria-label="GroupingSearch" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.GroupingSearch.search">
    search()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field">
    Field
  </a>
<nav aria-label="Field" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.settings">
    settings
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.String">
    String()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.Text">
    Text()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField">
    NestedField
  </a>
<nav aria-label="NestedField" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.prefix">
    prefix()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.range">
    range()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.values">
    values()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField">
    DateTimeField
  </a>
<nav aria-label="DateTimeField" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.duration">
    duration()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.prefix">
    prefix()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.range">
    range()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.timestamp">
    timestamp()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.within">
    within()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField">
    SpatialField
  </a>
<nav aria-label="SpatialField" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField.distances">
    distances()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField.within">
    within()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#queries">
    queries
  </a>
<nav aria-label="queries" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query">
    Query
  </a>
<nav aria-label="Query" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__and__">
    __and__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__neg__">
    __neg__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__new__">
    __new__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__or__">
    __or__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__pos__">
    __pos__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__sub__">
    __sub__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.all">
    all()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.alldocs">
    alldocs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.any">
    any()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.boost">
    boost()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.constant">
    constant()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.disjunct">
    disjunct()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.filter">
    filter()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.fuzzy">
    fuzzy()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.near">
    near()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.nodocs">
    nodocs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.phrase">
    phrase()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.points">
    points()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.prefix">
    prefix()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.range">
    range()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.ranges">
    ranges()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.regexp">
    regexp()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.span">
    span()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.term">
    term()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.terms">
    terms()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.wildcard">
    wildcard()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery">
    SpanQuery
  </a>
<nav aria-label="SpanQuery" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.boost">
    boost()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.containing">
    containing()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.mask">
    mask()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.near">
    near()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.within">
    within()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpellParser">
    SpellParser
  </a>
<nav aria-label="SpellParser" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpellParser.rewrite">
    rewrite()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpellParser.suggest">
    suggest()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../services/">
      Services
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../examples/">
      Examples
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#analyzers">
    analyzers
  </a>
<nav aria-label="analyzers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream">
    TokenStream
  </a>
<nav aria-label="TokenStream" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.charTerm">
    charTerm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.offset">
    offset
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.payload">
    payload
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.positionIncrement">
    positionIncrement
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenStream.type">
    type
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenFilter">
    TokenFilter
  </a>
<nav aria-label="TokenFilter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.TokenFilter.incrementToken">
    incrementToken()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer">
    Analyzer
  </a>
<nav aria-label="Analyzer" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.highlight">
    highlight()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.parse">
    parse()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.standard">
    standard()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.tokens">
    tokens()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.analyzers.Analyzer.whitespace">
    whitespace()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#indexers">
    indexers
  </a>
<nav aria-label="indexers" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader">
    IndexReader
  </a>
<nav aria-label="IndexReader" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.directory">
    directory
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.fieldinfos">
    fieldinfos
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.path">
    path
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.readers">
    readers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.segments">
    segments
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.timestamp">
    timestamp
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.copy">
    copy()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.docs">
    docs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.docvalues">
    docvalues()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.morelikethis">
    morelikethis()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.positions">
    positions()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.positionvector">
    positionvector()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.sortfield">
    sortfield()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.suggest">
    suggest()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.terms">
    terms()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexReader.termvector">
    termvector()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher">
    IndexSearcher
  </a>
<nav aria-label="IndexSearcher" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.highlighter">
    highlighter
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.complete">
    complete()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.count">
    count()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.facets">
    facets()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.get">
    get()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.groupby">
    groupby()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.load">
    load()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.match">
    match()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.reopen">
    reopen()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.search">
    search()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.spans">
    spans()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexSearcher.spellchecker">
    spellchecker()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.MultiSearcher">
    MultiSearcher
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter">
    IndexWriter
  </a>
<nav aria-label="IndexWriter" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.__iadd__">
    __iadd__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.add">
    add()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.check">
    check()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.delete">
    delete()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.document">
    document()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.set">
    set()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.snapshot">
    snapshot()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.IndexWriter.update">
    update()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.Indexer">
    Indexer
  </a>
<nav aria-label="Indexer" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.Indexer.commit">
    commit()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.indexers.Indexer.refresh">
    refresh()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#documents">
    documents
  </a>
<nav aria-label="documents" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document">
    Document
  </a>
<nav aria-label="Document" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document.dict">
    dict()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document.get">
    get()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Document.getlist">
    getlist()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hit">
    Hit
  </a>
<nav aria-label="Hit" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hit.dict">
    dict()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits">
    Hits
  </a>
<nav aria-label="Hits" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.maxscore">
    maxscore
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.docvalues">
    docvalues()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.filter">
    filter()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.groupby">
    groupby()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.highlights">
    highlights()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.select">
    select()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Hits.sorted">
    sorted()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Groups">
    Groups
  </a>
<nav aria-label="Groups" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Groups.facets">
    facets
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Groups.select">
    select()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.GroupingSearch">
    GroupingSearch
  </a>
<nav aria-label="GroupingSearch" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.GroupingSearch.search">
    search()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field">
    Field
  </a>
<nav aria-label="Field" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.settings">
    settings
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.String">
    String()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.Field.Text">
    Text()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField">
    NestedField
  </a>
<nav aria-label="NestedField" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.prefix">
    prefix()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.range">
    range()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.NestedField.values">
    values()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField">
    DateTimeField
  </a>
<nav aria-label="DateTimeField" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.duration">
    duration()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.prefix">
    prefix()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.range">
    range()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.timestamp">
    timestamp()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.DateTimeField.within">
    within()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField">
    SpatialField
  </a>
<nav aria-label="SpatialField" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField.distances">
    distances()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField.items">
    items()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.documents.SpatialField.within">
    within()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#queries">
    queries
  </a>
<nav aria-label="queries" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query">
    Query
  </a>
<nav aria-label="Query" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__and__">
    __and__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__neg__">
    __neg__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__new__">
    __new__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__or__">
    __or__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__pos__">
    __pos__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.__sub__">
    __sub__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.all">
    all()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.alldocs">
    alldocs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.any">
    any()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.boost">
    boost()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.constant">
    constant()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.disjunct">
    disjunct()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.filter">
    filter()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.fuzzy">
    fuzzy()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.near">
    near()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.nodocs">
    nodocs()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.phrase">
    phrase()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.points">
    points()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.prefix">
    prefix()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.range">
    range()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.ranges">
    ranges()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.regexp">
    regexp()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.span">
    span()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.term">
    term()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.terms">
    terms()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.Query.wildcard">
    wildcard()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery">
    SpanQuery
  </a>
<nav aria-label="SpanQuery" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.boost">
    boost()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.containing">
    containing()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.mask">
    mask()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.near">
    near()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpanQuery.within">
    within()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpellParser">
    SpellParser
  </a>
<nav aria-label="SpellParser" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpellParser.rewrite">
    rewrite()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lupyne.engine.queries.SpellParser.suggest">
    suggest()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1>Engine</h1>
<h2 id="analyzers">analyzers</h2>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.analyzers.TokenStream">
<code>lupyne.engine.analyzers.TokenStream</code>
</h3>
<div class="doc doc-contents first">
<p>TokenStream mixin with support for iteration and attributes cached as properties.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.TokenStream.charTerm">
<code class="highlight">
charTerm: <span class="nb">str</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-writable"><code>writable</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>term text</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.TokenStream.offset">
<code class="highlight">
offset: <span class="nb">tuple</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-writable"><code>writable</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>start and stop character offset</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.TokenStream.payload">
<code class="highlight">
payload        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-writable"><code>writable</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>payload bytes</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.TokenStream.positionIncrement">
<code class="highlight">
positionIncrement: <span class="nb">int</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-writable"><code>writable</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>position relative to the previous token</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.TokenStream.type">
<code class="highlight">
type: <span class="nb">str</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-writable"><code>writable</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>lexical type</p>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.analyzers.TokenFilter">
<code>lupyne.engine.analyzers.TokenFilter</code>
</h3>
<div class="doc doc-contents first">
<p>Create an iterable lucene TokenFilter from a TokenStream.</p>
<p>Subclass and override <a href="#lupyne.engine.analyzers.TokenFilter.incrementToken">incrementToken</a>.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.TokenFilter.incrementToken">
<code class="highlight language-python">
incrementToken<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Advance to next token and return whether the stream is not empty.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/analyzers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">incrementToken</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""Advance to next token and return whether the stream is not empty."""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">incrementToken</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.analyzers.Analyzer">
<code>lupyne.engine.analyzers.Analyzer</code>
</h3>
<div class="doc doc-contents first">
<p>Return a lucene Analyzer which chains together a tokenizer and filters.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tokenizer</code></td>
<td><code></code></td>
<td>
<p>lucene Tokenizer class or callable, called with no args</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>filters</code></td>
<td><code></code></td>
<td>
<p>lucene TokenFilter classes or callables, successively called on input tokens</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.Analyzer.highlight">
<code class="highlight language-python">
highlight<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return highlighted content.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>Query</code></td>
<td>
<p>lucene Query</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>field</code></td>
<td><code>str</code></td>
<td>
<p>field name</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>content</code></td>
<td><code>str</code></td>
<td>
<p>text</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>count</code></td>
<td><code>int</code></td>
<td>
<p>optional maximum number of passages</p>
</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/analyzers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""Return highlighted content.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: lucene Query</span>
<span class="sd">        field: field name</span>
<span class="sd">        content: text</span>
<span class="sd">        count: optional maximum number of passages</span>
<span class="sd">    """</span>
    <span class="n">highlighter</span> <span class="o">=</span> <span class="n">uhighlight</span><span class="o">.</span><span class="n">UnifiedHighlighter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">highlighter</span><span class="o">.</span><span class="n">highlightWithoutSearcher</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.Analyzer.parse">
<code class="highlight language-python">
parse<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return parsed lucene Query.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>str</code></td>
<td>
<p>query string</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>field</code></td>
<td><code></code></td>
<td>
<p>default query field name, sequence of names, or boost mapping</p>
</td>
<td><code>''</code></td>
</tr>
<tr>
<td><code>op</code></td>
<td><code></code></td>
<td>
<p>default query operator ('or', 'and')</p>
</td>
<td><code>''</code></td>
</tr>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>custom PythonQueryParser class</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code></code></td>
<td>
<p>additional attributes to set on the parser</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/analyzers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return parsed lucene Query.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: query string</span>
<span class="sd">        field: default query field name, sequence of names, or boost mapping</span>
<span class="sd">        op: default query operator ('or', 'and')</span>
<span class="sd">        parser: custom PythonQueryParser class</span>
<span class="sd">        attrs: additional attributes to set on the parser</span>
<span class="sd">    """</span>
    <span class="c1"># parsers aren't thread-safe (nor slow), so create one each time</span>
    <span class="bp">cls</span> <span class="o">=</span> <span class="n">queryparser</span><span class="o">.</span><span class="n">classic</span><span class="o">.</span><span class="n">QueryParser</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">queryparser</span><span class="o">.</span><span class="n">classic</span><span class="o">.</span><span class="n">MultiFieldQueryParser</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">field</span><span class="p">,</span> <span class="bp">self</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="n">boosts</span> <span class="o">=</span> <span class="n">HashMap</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
            <span class="n">boosts</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="bp">self</span><span class="p">,</span> <span class="n">boosts</span>  <span class="c1"># type: ignore</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="p">(</span><span class="n">parser</span> <span class="ow">or</span> <span class="bp">cls</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">op</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">defaultOperator</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">queryparser</span><span class="o">.</span><span class="n">classic</span><span class="o">.</span><span class="n">QueryParser</span><span class="o">.</span><span class="n">Operator</span><span class="p">,</span> <span class="n">op</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">queryparser</span><span class="o">.</span><span class="n">classic</span><span class="o">.</span><span class="n">MultiFieldQueryParser</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">PythonQueryParser</span><span class="p">):</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.Analyzer.standard">
<code class="highlight language-python">
standard<span class="p">(</span><span class="o">*</span><span class="n">filters</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return equivalent of StandardAnalyzer with additional filters.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/analyzers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">standard</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">filters</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Analyzer'</span><span class="p">:</span>
    <span class="sd">"""Return equivalent of StandardAnalyzer with additional filters."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">standard</span><span class="o">.</span><span class="n">StandardTokenizer</span><span class="p">,</span> <span class="n">analysis</span><span class="o">.</span><span class="n">LowerCaseFilter</span><span class="p">,</span> <span class="o">*</span><span class="n">filters</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.Analyzer.tokens">
<code class="highlight language-python">
tokens<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene TokenStream from text.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/analyzers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">analysis</span><span class="o">.</span><span class="n">TokenStream</span><span class="p">:</span>
    <span class="sd">"""Return lucene TokenStream from text."""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">StringReader</span><span class="p">(</span><span class="n">text</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.analyzers.Analyzer.whitespace">
<code class="highlight language-python">
whitespace<span class="p">(</span><span class="o">*</span><span class="n">filters</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return equivalent of WhitespaceAnalyzer with additional filters.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/analyzers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">whitespace</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">filters</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Analyzer'</span><span class="p">:</span>
    <span class="sd">"""Return equivalent of WhitespaceAnalyzer with additional filters."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">WhitespaceTokenizer</span><span class="p">,</span> <span class="o">*</span><span class="n">filters</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="indexers">indexers</h2>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader">
<code>lupyne.engine.indexers.IndexReader</code>
</h3>
<div class="doc doc-contents first">
<p>Delegated lucene IndexReader, with a mapping interface of ids to document objects.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>reader</code></td>
<td><code></code></td>
<td>
<p>lucene IndexReader</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.directory">
<code class="highlight">
directory: <span class="n">Directory</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>reader's lucene Directory</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.fieldinfos">
<code class="highlight">
fieldinfos: <span class="nb">dict</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>mapping of field names to lucene FieldInfos</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.path">
<code class="highlight">
path: <span class="nb">str</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>FSDirectory path</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.readers">
<code class="highlight">
readers: <span class="n">Iterator</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>segment readers</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.segments">
<code class="highlight">
segments: <span class="nb">dict</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>segment filenames with document counts</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.timestamp">
<code class="highlight">
timestamp: <span class="nb">float</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>timestamp of reader's last commit</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.copy">
<code class="highlight language-python">
copy<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Copy the index to the destination directory.</p>
<p>Optimized to use hard links if the destination is a file system path.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dest</code></td>
<td><code></code></td>
<td>
<p>destination directory path or lucene Directory</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code>Query</code></td>
<td>
<p>optional lucene Query to select documents</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>exclude</code></td>
<td><code>Query</code></td>
<td>
<p>optional lucene Query to exclude documents</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>merge</code></td>
<td><code>int</code></td>
<td>
<p>optionally merge into maximum number of segments</p>
</td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">merge</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Copy the index to the destination directory.</span>

<span class="sd">    Optimized to use hard links if the destination is a file system path.</span>

<span class="sd">    Args:</span>
<span class="sd">        dest: destination directory path or lucene Directory</span>
<span class="sd">        query: optional lucene Query to select documents</span>
<span class="sd">        exclude: optional lucene Query to exclude documents</span>
<span class="sd">        merge: optionally merge into maximum number of segments</span>
<span class="sd">    """</span>
    <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexCommit</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">IndexWriter</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">query</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">Query</span><span class="o">.</span><span class="n">alldocs</span><span class="p">()</span> <span class="o">-</span> <span class="n">query</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exclude</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">exclude</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">forceMergeDeletes</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">merge</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">forceMerge</span><span class="p">(</span><span class="n">merge</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">writer</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.docs">
<code class="highlight language-python">
docs<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate doc ids which contain given term, optionally with frequency counts.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">docs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
    <span class="sd">"""Generate doc ids which contain given term, optionally with frequency counts."""</span>
    <span class="n">docsenum</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">MultiTerms</span><span class="o">.</span><span class="n">getTermPostingsEnum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexReader</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">docsenum</span><span class="o">.</span><span class="n">nextDoc</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">PostingsEnum</span><span class="o">.</span><span class="n">NO_MORE_DOCS</span><span class="p">)</span> <span class="k">if</span> <span class="n">docsenum</span> <span class="k">else</span> <span class="p">()</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">doc</span><span class="p">,</span> <span class="n">docsenum</span><span class="o">.</span><span class="n">freq</span><span class="p">())</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">)</span> <span class="k">if</span> <span class="n">counts</span> <span class="k">else</span> <span class="nb">iter</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.docvalues">
<code class="highlight language-python">
docvalues<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return chained lucene DocValues, suitable for custom sorting or grouping.</p>
<p>Note multi-valued DocValues aren't thread-safe and only supported ordered iteration.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>field name</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>type</code></td>
<td><code></code></td>
<td>
<p>int or float for converting values</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">docvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DocValues</span><span class="o">.</span><span class="n">Sorted</span><span class="p">:</span>
    <span class="sd">"""Return chained lucene DocValues, suitable for custom sorting or grouping.</span>

<span class="sd">    Note multi-valued DocValues aren't thread-safe and only supported ordered iteration.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: field name</span>
<span class="sd">        type: int or float for converting values</span>
<span class="sd">    """</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">NumericUtils</span><span class="o">.</span><span class="n">sortableLongToDouble</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="o">.</span><span class="n">utf8ToString</span><span class="p">)</span>
    <span class="n">docValuesType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldinfos</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">docValuesType</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'_'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">MultiDocValues</span><span class="p">,</span> <span class="sa">f</span><span class="s1">'get</span><span class="si">{</span><span class="n">docValuesType</span><span class="si">}</span><span class="s1">Values'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">DocValues</span><span class="p">,</span> <span class="n">docValuesType</span><span class="p">)(</span><span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexReader</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">type</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.morelikethis">
<code class="highlight language-python">
morelikethis<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return MoreLikeThis query for document.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>doc</code></td>
<td><code></code></td>
<td>
<p>document id or text</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code></code></td>
<td>
<p>document fields to use, optional for termvectors</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code></code></td>
<td>
<p>additional attributes to set on the morelikethis object</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">morelikethis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return MoreLikeThis query for document.</span>

<span class="sd">    Args:</span>
<span class="sd">        doc: document id or text</span>
<span class="sd">        fields: document fields to use, optional for termvectors</span>
<span class="sd">        attrs: additional attributes to set on the morelikethis object</span>
<span class="sd">    """</span>
    <span class="n">mlt</span> <span class="o">=</span> <span class="n">queries</span><span class="o">.</span><span class="n">mlt</span><span class="o">.</span><span class="n">MoreLikeThis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexReader</span><span class="p">)</span>
    <span class="n">mlt</span><span class="o">.</span><span class="n">fieldNames</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">mlt</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mlt</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">StringReader</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">mlt</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.positions">
<code class="highlight language-python">
positions<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">payloads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate doc ids and positions which contain given term.</p>
<p>Optionally with offsets, or only ones with payloads.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">payloads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
    <span class="sd">"""Generate doc ids and positions which contain given term.</span>

<span class="sd">    Optionally with offsets, or only ones with payloads."""</span>
    <span class="n">docsenum</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">MultiTerms</span><span class="o">.</span><span class="n">getTermPostingsEnum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexReader</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">docsenum</span><span class="o">.</span><span class="n">nextDoc</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">PostingsEnum</span><span class="o">.</span><span class="n">NO_MORE_DOCS</span><span class="p">)</span> <span class="k">if</span> <span class="n">docsenum</span> <span class="k">else</span> <span class="p">():</span>  <span class="c1"># type: ignore</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="p">(</span><span class="n">docsenum</span><span class="o">.</span><span class="n">nextPosition</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">docsenum</span><span class="o">.</span><span class="n">freq</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">payloads</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="p">((</span><span class="n">position</span><span class="p">,</span> <span class="n">docsenum</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">utf8ToString</span><span class="p">())</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span> <span class="k">if</span> <span class="n">docsenum</span><span class="o">.</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">offsets</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="p">((</span><span class="n">docsenum</span><span class="o">.</span><span class="n">startOffset</span><span class="p">(),</span> <span class="n">docsenum</span><span class="o">.</span><span class="n">endOffset</span><span class="p">())</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">doc</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.positionvector">
<code class="highlight language-python">
positionvector<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate terms and positions for given doc id and field, optionally with character offsets.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">positionvector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
    <span class="sd">"""Generate terms and positions for given doc id and field, optionally with character offsets."""</span>
    <span class="n">termsenum</span><span class="p">,</span> <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
        <span class="n">docsenum</span> <span class="o">=</span> <span class="n">termsenum</span><span class="o">.</span><span class="n">postings</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">docsenum</span><span class="o">.</span><span class="n">nextDoc</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">docsenum</span><span class="o">.</span><span class="n">NO_MORE_DOCS</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="p">(</span><span class="n">docsenum</span><span class="o">.</span><span class="n">nextPosition</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">docsenum</span><span class="o">.</span><span class="n">freq</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">offsets</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="p">((</span><span class="n">docsenum</span><span class="o">.</span><span class="n">startOffset</span><span class="p">(),</span> <span class="n">docsenum</span><span class="o">.</span><span class="n">endOffset</span><span class="p">())</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">term</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.sortfield">
<code class="highlight language-python">
sortfield<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene SortField, deriving the the type from FieldInfos if necessary.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>field name</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>type</code></td>
<td><code></code></td>
<td>
<p>int, float, or name compatible with SortField constants</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>reverse</code></td>
<td><code></code></td>
<td>
<p>reverse flag used with sort</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sortfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">search</span><span class="o">.</span><span class="n">SortField</span><span class="p">:</span>
    <span class="sd">"""Return lucene SortField, deriving the the type from FieldInfos if necessary.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: field name</span>
<span class="sd">        type: int, float, or name compatible with SortField constants</span>
<span class="sd">        reverse: reverse flag used with sort</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldinfos</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">docValuesType</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">Field</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">search</span><span class="o">.</span><span class="n">SortField</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">SortField</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="nb">type</span><span class="p">),</span> <span class="n">reverse</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.suggest">
<code class="highlight language-python">
suggest<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return spelling suggestions from DirectSpellChecker.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>field name</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>value</code></td>
<td><code></code></td>
<td>
<p>term</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>count</code></td>
<td><code>int</code></td>
<td>
<p>maximum number of suggestions</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code></code></td>
<td>
<p>DirectSpellChecker options</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">suggest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""Return spelling suggestions from DirectSpellChecker.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: field name</span>
<span class="sd">        value: term</span>
<span class="sd">        count: maximum number of suggestions</span>
<span class="sd">        attrs: DirectSpellChecker options</span>
<span class="sd">    """</span>
    <span class="n">checker</span> <span class="o">=</span> <span class="n">spell</span><span class="o">.</span><span class="n">DirectSpellChecker</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">checker</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">string</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">checker</span><span class="o">.</span><span class="n">suggestSimilar</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexReader</span><span class="p">)]</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.terms">
<code class="highlight language-python">
terms<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate a slice of term values, optionally with frequency counts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>field name</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>value</code></td>
<td><code></code></td>
<td>
<p>term prefix, start value (given stop), or fuzzy value (given distance)</p>
</td>
<td><code>''</code></td>
</tr>
<tr>
<td><code>stop</code></td>
<td><code></code></td>
<td>
<p>optional upper bound for range terms</p>
</td>
<td><code>''</code></td>
</tr>
<tr>
<td><code>counts</code></td>
<td><code></code></td>
<td>
<p>include frequency counts</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>distance</code></td>
<td><code></code></td>
<td>
<p>maximum edit distance for fuzzy terms</p>
</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>prefix</code></td>
<td><code></code></td>
<td>
<p>prefix length for fuzzy terms</p>
</td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
    <span class="sd">"""Generate a slice of term values, optionally with frequency counts.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: field name</span>
<span class="sd">        value: term prefix, start value (given stop), or fuzzy value (given distance)</span>
<span class="sd">        stop: optional upper bound for range terms</span>
<span class="sd">        counts: include frequency counts</span>
<span class="sd">        distance: maximum edit distance for fuzzy terms</span>
<span class="sd">        prefix: prefix length for fuzzy terms</span>
<span class="sd">    """</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">MultiTerms</span><span class="o">.</span><span class="n">getTerms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexReader</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">terms</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">([])</span>
    <span class="n">term</span><span class="p">,</span> <span class="n">termsenum</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">terms</span><span class="o">.</span><span class="n">iterator</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">distance</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">if</span> <span class="n">lucene</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&lt;</span> <span class="s1">'8.6'</span><span class="p">:</span>
            <span class="n">terms</span> <span class="o">=</span> <span class="n">termsenum</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">FuzzyTermsEnum</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">AttributeSource</span><span class="p">(),</span> <span class="n">term</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">terms</span> <span class="o">=</span> <span class="n">termsenum</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">FuzzyTermsEnum</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">termsenum</span><span class="o">.</span><span class="n">seekCeil</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">([</span><span class="n">termsenum</span><span class="o">.</span><span class="n">term</span><span class="p">()],</span> <span class="n">util</span><span class="o">.</span><span class="n">BytesRefIterator</span><span class="o">.</span><span class="n">cast_</span><span class="p">(</span><span class="n">termsenum</span><span class="p">))</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">methodcaller</span><span class="p">(</span><span class="s1">'utf8ToString'</span><span class="p">),</span> <span class="n">terms</span><span class="p">)</span>
    <span class="n">predicate</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span> <span class="k">if</span> <span class="n">stop</span> <span class="k">else</span> <span class="n">operator</span><span class="o">.</span><span class="n">methodcaller</span><span class="p">(</span><span class="s1">'startswith'</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">distance</span><span class="p">:</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">takewhile</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">terms</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="n">termsenum</span><span class="o">.</span><span class="n">docFreq</span><span class="p">())</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">)</span> <span class="k">if</span> <span class="n">counts</span> <span class="k">else</span> <span class="n">terms</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexReader.termvector">
<code class="highlight language-python">
termvector<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate terms for given doc id and field, optionally with frequency counts.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">termvector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
    <span class="sd">"""Generate terms for given doc id and field, optionally with frequency counts."""</span>
    <span class="n">termsenum</span><span class="p">,</span> <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">termsenum</span><span class="o">.</span><span class="n">totalTermFreq</span><span class="p">()))</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">)</span> <span class="k">if</span> <span class="n">counts</span> <span class="k">else</span> <span class="n">terms</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher">
<code>lupyne.engine.indexers.IndexSearcher</code>
</h3>
<div class="doc doc-contents first">
<p>Inherited lucene IndexSearcher, with a mixed-in IndexReader.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>directory</code></td>
<td><code></code></td>
<td>
<p>directory path, lucene Directory, or lucene IndexReader</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>analyzer</code></td>
<td><code></code></td>
<td>
<p>lucene Analyzer, default StandardAnalyzer</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.highlighter">
<code class="highlight">
highlighter: <span class="n">UnifiedHighlighter</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>lucene UnifiedHighlighter</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.complete">
<code class="highlight language-python">
complete<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return ordered suggested words for prefix.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""Return ordered suggested words for prefix."""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spellchecker</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.count">
<code class="highlight language-python">
count<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return number of hits for given query or term.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p><a href="#lupyne.engine.indexers.IndexSearcher.search">search</a> compatible query, or optimally a name and value</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>options</code></td>
<td><code></code></td>
<td>
<p>additional <a href="#lupyne.engine.indexers.IndexSearcher.search">search</a> options</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""Return number of hits for given query or term.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: [search][lupyne.engine.indexers.IndexSearcher.search] compatible query, or optimally a name and value</span>
<span class="sd">        options: additional [search][lupyne.engine.indexers.IndexSearcher.search] options</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">docFreq</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="o">*</span><span class="n">query</span><span class="p">))</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="o">*</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> <span class="k">if</span> <span class="n">query</span> <span class="k">else</span> <span class="n">Query</span><span class="o">.</span><span class="n">alldocs</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.facets">
<code class="highlight language-python">
facets<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">,</span> <span class="o">**</span><span class="n">query_map</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return mapping of document counts for the intersection with each facet.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>query string or lucene Query</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>str</code></td>
<td>
<p>field names for lucene GroupingSearch</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>query_map</code></td>
<td><code>dict</code></td>
<td>
<p><code>{facet: {key: query, ...}, ...}</code> for intersected query counts</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">facets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">query_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Return mapping of document counts for the intersection with each facet.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: query string or lucene Query</span>
<span class="sd">        fields: field names for lucene GroupingSearch</span>
<span class="sd">        query_map: `{facet: {key: query, ...}, ...}` for intersected query counts</span>
<span class="sd">    """</span>
    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">facets</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">facet</span><span class="p">,</span> <span class="n">queries</span> <span class="ow">in</span> <span class="n">query_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">counts</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Query</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">queries</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">counts</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.get">
<code class="highlight language-python">
get<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return <a href="#lupyne.engine.documents.Document">Document</a> with only selected fields loaded.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Document</span><span class="p">:</span>
    <span class="sd">"""Return [Document][lupyne.engine.documents.Document] with only selected fields loaded."""</span>
    <span class="k">return</span> <span class="n">Document</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">HashSet</span><span class="p">(</span><span class="n">Arrays</span><span class="o">.</span><span class="n">asList</span><span class="p">(</span><span class="n">fields</span><span class="p">))))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.groupby">
<code class="highlight language-python">
groupby<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return <a href="#lupyne.engine.documents.Hits">Hits</a> grouped by field
using a <a href="#lupyne.engine.documents.GroupingSearch">GroupingSearch</a>.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Groups</span><span class="p">:</span>
    <span class="sd">"""Return [Hits][lupyne.engine.documents.Hits] grouped by field</span>
<span class="sd">    using a [GroupingSearch][lupyne.engine.documents.GroupingSearch]."""</span>
    <span class="k">return</span> <span class="n">GroupingSearch</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">query</span><span class="p">),</span> <span class="n">count</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.load">
<code class="highlight language-python">
load<span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">analyzer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Open <a href="#lupyne.engine.indexers.IndexSearcher">IndexSearcher</a> with a lucene RAMDirectory,
loading index into memory.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">analyzer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'IndexSearcher'</span><span class="p">:</span>
    <span class="sd">"""Open [IndexSearcher][lupyne.engine.indexers.IndexSearcher] with a lucene RAMDirectory,</span>
<span class="sd">    loading index into memory."""</span>
    <span class="k">with</span> <span class="n">closing</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="k">as</span> <span class="n">directory</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">RAMDirectory</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">store</span><span class="o">.</span><span class="n">IOContext</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">)</span>
    <span class="bp">self</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">analyzer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.match">
<code class="highlight language-python">
match<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate scores for all queries against a given document mapping.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="sd">"""Generate scores for all queries against a given document mapping."""</span>
    <span class="n">searcher</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">MemoryIndex</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">]</span> <span class="o">*</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">searcher</span><span class="o">.</span><span class="n">addField</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">searcher</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">query</span><span class="p">))</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.reopen">
<code class="highlight language-python">
reopen<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spellcheckers</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return current <a href="#lupyne.engine.indexers.IndexSearcher">IndexSearcher</a>, only creating a new one if necessary.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>spellcheckers</code></td>
<td><code></code></td>
<td>
<p>refresh cached :attr:<code>spellcheckers</code></p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">reopen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spellcheckers</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'IndexSearcher'</span><span class="p">:</span>
    <span class="sd">"""Return current [IndexSearcher][lupyne.engine.indexers.IndexSearcher], only creating a new one if necessary.</span>

<span class="sd">    Args:</span>
<span class="sd">        spellcheckers: refresh cached :attr:`spellcheckers`</span>
<span class="sd">    """</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openIfChanged</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="n">other</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">reader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">)</span>
    <span class="n">other</span><span class="o">.</span><span class="n">decRef</span><span class="p">()</span>
    <span class="n">other</span><span class="o">.</span><span class="n">shared</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared</span>
    <span class="k">if</span> <span class="n">spellcheckers</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spellcheckers</span><span class="p">:</span>
            <span class="n">other</span><span class="o">.</span><span class="n">spellchecker</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">other</span><span class="o">.</span><span class="n">spellcheckers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spellcheckers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">other</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.search">
<code class="highlight language-python">
search<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mincount</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">parser</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Run query and return <a href="#lupyne.engine.documents.Hits">Hits</a>.</p>
<p>!!! note
    changed in version 2.3: maxscore option removed; use Hits.maxscore property</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>query string or lucene Query</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>count</code></td>
<td><code></code></td>
<td>
<p>maximum number of hits to retrieve</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code></code></td>
<td>
<p>lucene Sort parameters</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>reverse</code></td>
<td><code></code></td>
<td>
<p>reverse flag used with sort</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>scores</code></td>
<td><code></code></td>
<td>
<p>compute scores for candidate results when sorting</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>mincount</code></td>
<td><code></code></td>
<td>
<p>total hit count accuracy threshold</p>
</td>
<td><code>1000</code></td>
</tr>
<tr>
<td><code>timeout</code></td>
<td><code></code></td>
<td>
<p>stop search after elapsed number of seconds</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p><a href="#lupyne.engine.analyzers.Analyzer.parse">parse</a>` options</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">search</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mincount</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">parser</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Hits</span><span class="p">:</span>
    <span class="sd">"""Run query and return [Hits][lupyne.engine.documents.Hits].</span>

<span class="sd">    Note:</span>
<span class="sd">        changed in version 2.3: maxscore option removed; use Hits.maxscore property</span>

<span class="sd">    Args:</span>
<span class="sd">        query: query string or lucene Query</span>
<span class="sd">        count: maximum number of hits to retrieve</span>
<span class="sd">        sort: lucene Sort parameters</span>
<span class="sd">        reverse: reverse flag used with sort</span>
<span class="sd">        scores: compute scores for candidate results when sorting</span>
<span class="sd">        mincount: total hit count accuracy threshold</span>
<span class="sd">        timeout: stop search after elapsed number of seconds</span>
<span class="sd">        parser: [parse][lupyne.engine.analyzers.Analyzer.parse]` options</span>
<span class="sd">    """</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="o">.</span><span class="n">alldocs</span><span class="p">()</span> <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">parser</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">collector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">mincount</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">TimeLimitingCollector</span><span class="o">.</span><span class="n">getGlobalCounter</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">TimeLimitingCollector</span><span class="p">(</span><span class="n">collector</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">TimeLimitingCollector</span><span class="o">.</span><span class="n">TimeExceededException</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cache</span><span class="p">,</span> <span class="n">search</span><span class="o">.</span><span class="n">CachingCollector</span><span class="p">):</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">TotalHitCountCollector</span><span class="p">()</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">replay</span><span class="p">(</span><span class="n">collector</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">totalHits</span> <span class="ow">or</span> <span class="mi">1</span>
        <span class="n">collector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collector</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="n">reverse</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">replay</span><span class="p">(</span><span class="n">collector</span><span class="p">)</span>
    <span class="n">topdocs</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">topDocs</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">scores</span><span class="p">:</span>
        <span class="n">search</span><span class="o">.</span><span class="n">TopFieldCollector</span><span class="o">.</span><span class="n">populateScores</span><span class="p">(</span><span class="n">topdocs</span><span class="o">.</span><span class="n">scoreDocs</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Hits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topdocs</span><span class="o">.</span><span class="n">scoreDocs</span><span class="p">,</span> <span class="n">topdocs</span><span class="o">.</span><span class="n">totalHits</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.spans">
<code class="highlight language-python">
spans<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate docs with occurrence counts for a span query.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>SpanQuery</code></td>
<td>
<p>lucene SpanQuery</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>positions</code></td>
<td><code></code></td>
<td>
<p>optionally include slice positions instead of counts</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">spans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">spans</span><span class="o">.</span><span class="n">SpanQuery</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
    <span class="sd">"""Generate docs with occurrence counts for a span query.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: lucene SpanQuery</span>
<span class="sd">        positions: optionally include slice positions instead of counts</span>
<span class="sd">    """</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">createWeight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="o">.</span><span class="n">ScoreMode</span><span class="o">.</span><span class="n">COMPLETE_NO_SCORES</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">postings</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">SpanWeight</span><span class="o">.</span><span class="n">Postings</span><span class="o">.</span><span class="n">POSITIONS</span>
    <span class="k">for</span> <span class="n">reader</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">readers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">spans</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">getSpans</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="n">postings</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">lucene</span><span class="o">.</span><span class="n">JavaError</span><span class="p">:</span>  <span class="c1"># EOF</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">nextDoc</span><span class="p">,</span> <span class="n">spans</span><span class="o">.</span><span class="n">NO_MORE_DOCS</span><span class="p">):</span>  <span class="c1"># type: int</span>
            <span class="n">starts</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">nextStartPosition</span><span class="p">,</span> <span class="n">spans</span><span class="o">.</span><span class="n">NO_MORE_POSITIONS</span><span class="p">)</span>  <span class="c1"># type: Iterator</span>
            <span class="k">if</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">spans</span><span class="o">.</span><span class="n">endPosition</span><span class="p">())</span> <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">starts</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">starts</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">doc</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span> <span class="n">values</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="n">reader</span><span class="o">.</span><span class="n">maxDoc</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexSearcher.spellchecker">
<code class="highlight language-python">
spellchecker<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return and cache spellchecker for given field.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">spellchecker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpellChecker</span><span class="p">:</span>
    <span class="sd">"""Return and cache spellchecker for given field."""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spellcheckers</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spellcheckers</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">SpellChecker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">terms</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.indexers.MultiSearcher">
<code>lupyne.engine.indexers.MultiSearcher</code>
</h3>
<div class="doc doc-contents first">
<p>IndexSearcher with underlying lucene MultiReader.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>reader</code></td>
<td><code></code></td>
<td>
<p>directory paths, Directories, IndexReaders, or a single MultiReader</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>analyzer</code></td>
<td><code></code></td>
<td>
<p>lucene Analyzer, default StandardAnalyzer</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter">
<code>lupyne.engine.indexers.IndexWriter</code>
</h3>
<div class="doc doc-contents first">
<p>Inherited lucene IndexWriter.</p>
<p>Supports setting fields parameters explicitly, so documents can be represented as dictionaries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>directory</code></td>
<td><code></code></td>
<td>
<p>directory path or lucene Directory, default RAMDirectory</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>mode</code></td>
<td><code></code></td>
<td>
<p>file mode (rwa), except updating (+) is implied</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>analyzer</code></td>
<td><code></code></td>
<td>
<p>lucene Analyzer, default StandardAnalyzer</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>version</code></td>
<td><code></code></td>
<td>
<p>lucene Version argument passed to IndexWriterConfig, default is latest</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code></code></td>
<td>
<p>additional attributes to set on IndexWriterConfig</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.__iadd__">
<code class="highlight language-python">
__iadd__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Add directory (or reader, searcher, writer) to index.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
    <span class="sd">"""Add directory (or reader, searcher, writer) to index."""</span>
    <span class="k">with</span> <span class="n">closing</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">'directory'</span><span class="p">,</span> <span class="n">directory</span><span class="p">))</span> <span class="k">as</span> <span class="n">directory</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addIndexes</span><span class="p">([</span><span class="n">directory</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.add">
<code class="highlight language-python">
add<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Add <a href="#lupyne.engine.indexers.IndexWriter.document">document</a> to index with optional boost.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">terms</span><span class="p">):</span>
    <span class="sd">"""Add [document][lupyne.engine.indexers.IndexWriter.document] to index with optional boost."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addDocument</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.check">
<code class="highlight language-python">
check<span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Check and optionally fix unlocked index, returning lucene CheckIndex.Status.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">index</span><span class="o">.</span><span class="n">CheckIndex</span><span class="o">.</span><span class="n">Status</span><span class="p">:</span>
    <span class="sd">"""Check and optionally fix unlocked index, returning lucene CheckIndex.Status."""</span>
    <span class="k">with</span> <span class="n">closing</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="k">as</span> <span class="n">directory</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">closing</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">CheckIndex</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span> <span class="k">as</span> <span class="n">checkindex</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">checkindex</span><span class="o">.</span><span class="n">checkIndex</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">fix</span><span class="p">:</span>
                <span class="n">checkindex</span><span class="o">.</span><span class="n">exorciseIndex</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">status</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.delete">
<code class="highlight language-python">
delete<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Remove documents which match given query or term.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p><a href="#lupyne.engine.indexers.IndexSearcher.search">search</a> compatible query, or optimally a name and value</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>options</code></td>
<td><code></code></td>
<td>
<p>additional <a href="#lupyne.engine.analyzers.Analyzer.parse">parse</a> options</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="sd">"""Remove documents which match given query or term.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: [search][lupyne.engine.indexers.IndexSearcher.search] compatible query, or optimally a name and value</span>
<span class="sd">        options: additional [parse][lupyne.engine.analyzers.Analyzer.parse] options</span>
<span class="sd">    """</span>
    <span class="n">parse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deleteDocuments</span><span class="p">(</span><span class="n">parse</span><span class="p">(</span><span class="o">*</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.document">
<code class="highlight language-python">
document<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene Document from mapping of field names to one or multiple values.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">document</span><span class="o">.</span><span class="n">Document</span><span class="p">:</span>
    <span class="sd">"""Return lucene Document from mapping of field names to one or multiple values."""</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">Document</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Atomic</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="n">values</span><span class="p">,)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">):</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">doc</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.set">
<code class="highlight language-python">
set<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">lupyne</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">documents</span><span class="o">.</span><span class="n">Field</span><span class="s1">'&gt;, **</span><span class="n">settings</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Assign settings to field name and return the field.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>registered name of field</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cls</code></td>
<td><code></code></td>
<td>
<p>optional <a href="#lupyne.engine.documents.Field">Field</a> constructor</p>
</td>
<td><code>&lt;class 'lupyne.engine.documents.Field'&gt;</code></td>
</tr>
<tr>
<td><code>settings</code></td>
<td><code></code></td>
<td>
<p>stored, indexed, etc. options compatible with <a href="#lupyne.engine.documents.Field">Field</a></p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">Field</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Field</span><span class="p">:</span>
    <span class="sd">"""Assign settings to field name and return the field.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: registered name of field</span>
<span class="sd">        cls: optional [Field][lupyne.engine.documents.Field] constructor</span>
<span class="sd">        settings: stored, indexed, etc. options compatible with [Field][lupyne.engine.documents.Field]</span>
<span class="sd">    """</span>
    <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">field</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.snapshot">
<code class="highlight language-python">
snapshot<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return context manager of an index commit snapshot.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span> <span class="nf">snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""Return context manager of an index commit snapshot."""</span>
    <span class="n">commit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">snapshot</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">commit</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">release</span><span class="p">(</span><span class="n">commit</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.IndexWriter.update">
<code class="highlight language-python">
update<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">document</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Atomically delete documents which match given term
and add the new <a href="#lupyne.engine.indexers.IndexWriter.document">document</a>.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">document</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">terms</span><span class="p">):</span>
    <span class="sd">"""Atomically delete documents which match given term</span>
<span class="sd">    and add the new [document][lupyne.engine.indexers.IndexWriter.document]."""</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span>
    <span class="n">term</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="n">doc</span><span class="o">.</span><span class="n">getValues</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">iterator</span><span class="p">())</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">Field</span><span class="o">.</span><span class="n">cast_</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">fieldType</span><span class="p">())</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span>
    <span class="n">noindex</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">IndexOptions</span><span class="o">.</span><span class="n">NONE</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">ft</span><span class="o">.</span><span class="n">stored</span><span class="p">()</span> <span class="ow">or</span> <span class="n">ft</span><span class="o">.</span><span class="n">indexOptions</span><span class="p">()</span> <span class="o">!=</span> <span class="n">noindex</span> <span class="ow">or</span> <span class="n">Field</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="n">ft</span><span class="p">)</span> <span class="k">for</span> <span class="n">ft</span> <span class="ow">in</span> <span class="n">types</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateDocument</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">fields</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateDocValues</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.indexers.Indexer">
<code>lupyne.engine.indexers.Indexer</code>
</h3>
<div class="doc doc-contents first">
<p>An all-purpose interface to an index.</p>
<p>Creates an <a href="#lupyne.engine.indexers.IndexWriter">IndexWriter</a>
with a delegated <a href="#lupyne.engine.indexers.IndexSearcher">IndexSearcher</a>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nrt</code></td>
<td><code></code></td>
<td>
<p>optionally use a near real-time searcher</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.Indexer.commit">
<code class="highlight language-python">
commit<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">caches</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Commit writes and <a href="#lupyne.engine.indexers.Indexer.refresh">refresh</a> searcher.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>merge</code></td>
<td><code></code></td>
<td>
<p>merge segments with deletes, or optionally specify maximum number of segments</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">merge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">caches</span><span class="p">):</span>
    <span class="sd">"""Commit writes and [refresh][lupyne.engine.indexers.Indexer.refresh] searcher.</span>

<span class="sd">    Args:</span>
<span class="sd">        merge: merge segments with deletes, or optionally specify maximum number of segments</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">merge</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">merge</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceMergeDeletes</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forceMerge</span><span class="p">(</span><span class="n">merge</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="o">**</span><span class="n">caches</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.indexers.Indexer.refresh">
<code class="highlight language-python">
refresh<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">caches</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Store refreshed searcher with <a href="#lupyne.engine.indexers.IndexSearcher.reopen">reopen</a> caches.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/indexers.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">caches</span><span class="p">):</span>
    <span class="sd">"""Store refreshed searcher with [reopen][lupyne.engine.indexers.IndexSearcher.reopen] caches."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">indexSearcher</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexSearcher</span><span class="o">.</span><span class="n">reopen</span><span class="p">(</span><span class="o">**</span><span class="n">caches</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="documents">documents</h2>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.Document">
<code>lupyne.engine.documents.Document</code>
</h3>
<div class="doc doc-contents first">
<p>Multimapping of field names to values, but default getters return the first value.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Document.dict">
<code class="highlight language-python">
dict<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return dict representation of document.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>names</code></td>
<td><code>str</code></td>
<td>
<p>names of multi-valued fields to return as a list</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>defaults</code></td>
<td><code></code></td>
<td>
<p>include only given fields, using default values as necessary</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Return dict representation of document.</span>

<span class="sd">    Args:</span>
<span class="sd">        names: names of multi-valued fields to return as a list</span>
<span class="sd">        defaults: include only given fields, using default values as necessary</span>
<span class="sd">    """</span>
    <span class="n">defaults</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="n">defaults</span> <span class="ow">or</span> <span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
    <span class="n">defaults</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">defaults</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Document.get">
<code class="highlight language-python">
get<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return the value for key if key is in the dictionary, else default.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">[</span><span class="n">default</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Document.getlist">
<code class="highlight language-python">
getlist<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return list of all values for given field.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">getlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""Return list of all values for given field."""</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">[])</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.Hit">
<code>lupyne.engine.documents.Hit</code>
</h3>
<div class="doc doc-contents first">
<p>A Document from a search result, with :attr:<code>id</code>, :attr:<code>score</code>, and optional :attr:<code>sortkeys</code>.</p>
<p>!!! note
    changed in version 2.4: keys renamed to :attr:<code>sortkeys</code></p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hit.dict">
<code class="highlight language-python">
dict<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return dict representation of document with <strong>id</strong>, <strong>score</strong>, and any sort <strong>keys</strong>.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Return dict representation of document with __id__, __score__, and any sort __keys__."""</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">__id__</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">__score__</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortkeys</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s1">'__sortkeys__'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortkeys</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.Hits">
<code>lupyne.engine.documents.Hits</code>
</h3>
<div class="doc doc-contents first">
<p>Search results: lazily evaluated and memory efficient.</p>
<p>Provides a read-only sequence interface to hit objects.</p>
<p>!!! note
    changed in version 2.3: maxscore option removed; computed property instead</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>searcher</code></td>
<td><code></code></td>
<td>
<p><a href="#lupyne.engine.indexers.IndexSearcher">IndexSearcher</a> which can retrieve documents</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>scoredocs</code></td>
<td><code></code></td>
<td>
<p>lucene ScoreDocs</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>count</code></td>
<td><code></code></td>
<td>
<p>total number of hits; float indicates estimate</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code></code></td>
<td>
<p>optional field selectors</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.maxscore">
<code class="highlight">
maxscore: <span class="nb">float</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>max score of present hits; not necessarily of all matches</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.docvalues">
<code class="highlight language-python">
docvalues<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return mapping of docs to docvalues.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">docvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""Return mapping of docs to docvalues."""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">searcher</span><span class="o">.</span><span class="n">docvalues</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.filter">
<code class="highlight language-python">
filter<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return <a href="#lupyne.engine.documents.Hits">Hits</a> filtered by function applied to doc ids.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Hits'</span><span class="p">:</span>
    <span class="sd">"""Return [Hits][lupyne.engine.documents.Hits] filtered by function applied to doc ids."""</span>
    <span class="n">scoredocs</span> <span class="o">=</span> <span class="p">[</span><span class="n">scoredoc</span> <span class="k">for</span> <span class="n">scoredoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoredocs</span> <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">scoredoc</span><span class="o">.</span><span class="n">doc</span><span class="p">)]</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">searcher</span><span class="p">,</span> <span class="n">scoredocs</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.groupby">
<code class="highlight language-python">
groupby<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">docs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return ordered list of <a href="#lupyne.engine.documents.Hits">Hits</a> grouped by value of function applied to doc ids.</p>
<p>Optionally limit the number of groups and docs per group.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Groups'</span><span class="p">:</span>
    <span class="sd">"""Return ordered list of [Hits][lupyne.engine.documents.Hits] grouped by value of function applied to doc ids.</span>

<span class="sd">    Optionally limit the number of groups and docs per group.</span>
<span class="sd">    """</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>  <span class="c1"># type: dict</span>
    <span class="k">for</span> <span class="n">scoredoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoredocs</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">scoredoc</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">searcher</span><span class="p">,</span> <span class="p">[],</span> <span class="n">fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">group</span><span class="o">.</span><span class="n">scoredocs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scoredoc</span><span class="p">)</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
        <span class="n">group</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">scoredocs</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">scoredocs</span><span class="p">[:</span><span class="n">docs</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Groups</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searcher</span><span class="p">,</span> <span class="n">groups</span><span class="p">[:</span><span class="n">count</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.highlights">
<code class="highlight language-python">
highlights<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">fields</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate highlighted fields for each hit.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>Query</code></td>
<td>
<p>lucene Query</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>field</code></td>
<td><code></code></td>
<td>
<p>mapping of fields to maxinum number of passages</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">highlights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">,</span> <span class="o">**</span><span class="n">fields</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
    <span class="sd">"""Generate highlighted fields for each hit.</span>

<span class="sd">    Args:</span>
<span class="sd">        query: lucene Query</span>
<span class="sd">        field: mapping of fields to maxinum number of passages</span>
<span class="sd">    """</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searcher</span><span class="o">.</span><span class="n">highlighter</span><span class="o">.</span><span class="n">highlightFields</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fields</span><span class="p">),</span> <span class="n">query</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span><span class="p">:</span> <span class="n">lucene</span><span class="o">.</span><span class="n">JArray_string</span><span class="o">.</span><span class="n">cast_</span><span class="p">(</span><span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">))</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mapping</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">mapping</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.items">
<code class="highlight language-python">
items<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate zipped ids and scores.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
    <span class="sd">"""Generate zipped ids and scores."""</span>
    <span class="k">return</span> <span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">'doc'</span><span class="p">,</span> <span class="s1">'score'</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoredocs</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.select">
<code class="highlight language-python">
select<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Only load selected fields.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">"""Only load selected fields."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">HashSet</span><span class="p">(</span><span class="n">Arrays</span><span class="o">.</span><span class="n">asList</span><span class="p">(</span><span class="n">fields</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Hits.sorted">
<code class="highlight language-python">
sorted<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return <a href="#lupyne.engine.documents.Hits">Hits</a> sorted by key function applied to doc ids.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Hits'</span><span class="p">:</span>
    <span class="sd">"""Return [Hits][lupyne.engine.documents.Hits] sorted by key function applied to doc ids."""</span>
    <span class="n">scoredocs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scoredocs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">scoredoc</span><span class="p">:</span> <span class="n">key</span><span class="p">(</span><span class="n">scoredoc</span><span class="o">.</span><span class="n">doc</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">searcher</span><span class="p">,</span> <span class="n">scoredocs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.Groups">
<code>lupyne.engine.documents.Groups</code>
</h3>
<div class="doc doc-contents first">
<p>Sequence of grouped <a href="#lupyne.engine.documents.Hits">Hits</a>.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Groups.facets">
<code class="highlight">
facets        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>mapping of field values and counts</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Groups.select">
<code class="highlight language-python">
select<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Only load selected fields.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">fields</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">"""Only load selected fields."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">HashSet</span><span class="p">(</span><span class="n">Arrays</span><span class="o">.</span><span class="n">asList</span><span class="p">(</span><span class="n">fields</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.GroupingSearch">
<code>lupyne.engine.documents.GroupingSearch</code>
</h3>
<div class="doc doc-contents first">
<p>Inherited lucene GroupingSearch with optimized faceting.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>field</code></td>
<td><code></code></td>
<td>
<p>unique field name to group by</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code></code></td>
<td>
<p>lucene Sort to order groups and docs</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cache</code></td>
<td><code></code></td>
<td>
<p>use unlimited caching</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code></code></td>
<td>
<p>additional attributes to set</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.GroupingSearch.search">
<code class="highlight language-python">
search<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searcher</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Run query and return <a href="#lupyne.engine.documents.Groups">Groups</a>.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searcher</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Groups</span><span class="p">:</span>
    <span class="sd">"""Run query and return [Groups][lupyne.engine.documents.Groups]."""</span>
    <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">DocValues</span><span class="o">.</span><span class="n">getSorted</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">)</span><span class="o">.</span><span class="n">valueCount</span> <span class="k">for</span> <span class="n">reader</span> <span class="ow">in</span> <span class="n">searcher</span><span class="o">.</span><span class="n">readers</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">1</span>
    <span class="n">topgroups</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">searcher</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">count</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Groups</span><span class="p">(</span><span class="n">searcher</span><span class="p">,</span> <span class="n">topgroups</span><span class="o">.</span><span class="n">groups</span><span class="p">,</span> <span class="n">topgroups</span><span class="o">.</span><span class="n">totalHitCount</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.Field">
<code>lupyne.engine.documents.Field</code>
</h3>
<div class="doc doc-contents first">
<p>Saved parameters which can generate lucene Fields given values.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>name of field</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>boost</code></td>
<td><code></code></td>
<td>
<p>boost factor</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>stored,</code></td>
<td><code>indexed, settings</code></td>
<td>
<p>lucene FieldType attributes</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Field.settings">
<code class="highlight">
settings: <span class="nb">dict</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-property"><code>property</code></small>
<small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>dict representation of settings</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Field.items">
<code class="highlight language-python">
items<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate lucene Fields suitable for adding to a document.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">document</span><span class="o">.</span><span class="n">Field</span><span class="p">]:</span>
    <span class="sd">"""Generate lucene Fields suitable for adding to a document."""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docvalues</span><span class="p">:</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">NumericUtils</span><span class="o">.</span><span class="n">doubleToSortableLong</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">docValueClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="p">)(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">'docValueLess'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">document</span><span class="o">.</span><span class="n">LongPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">document</span><span class="o">.</span><span class="n">DoublePoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexed</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">document</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">stored</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">document</span><span class="o">.</span><span class="n">StoredField</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Field.String">
<code class="highlight language-python">
String<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tokenized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">omitNorms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indexOptions</span><span class="o">=</span><span class="s1">'DOCS'</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return Field with default settings for strings.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">String</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tokenized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">omitNorms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indexOptions</span><span class="o">=</span><span class="s1">'DOCS'</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Field'</span><span class="p">:</span>
    <span class="sd">"""Return Field with default settings for strings."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tokenized</span><span class="o">=</span><span class="n">tokenized</span><span class="p">,</span> <span class="n">omitNorms</span><span class="o">=</span><span class="n">omitNorms</span><span class="p">,</span> <span class="n">indexOptions</span><span class="o">=</span><span class="n">indexOptions</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.Field.Text">
<code class="highlight language-python">
Text<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">indexOptions</span><span class="o">=</span><span class="s1">'DOCS_AND_FREQS_AND_POSITIONS'</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return Field with default settings for text.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">Text</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">indexOptions</span><span class="o">=</span><span class="s1">'DOCS_AND_FREQS_AND_POSITIONS'</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Field'</span><span class="p">:</span>
    <span class="sd">"""Return Field with default settings for text."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">indexOptions</span><span class="o">=</span><span class="n">indexOptions</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.NestedField">
<code>lupyne.engine.documents.NestedField</code>
</h3>
<div class="doc doc-contents first">
<p>Field which indexes every component into its own field.</p>
<p>Original value may be stored for convenience.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sep</code></td>
<td><code></code></td>
<td>
<p>field separator used on name and values</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.NestedField.items">
<code class="highlight language-python">
items<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate indexed component fields.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">document</span><span class="o">.</span><span class="n">Field</span><span class="p">]:</span>
    <span class="sd">"""Generate indexed component fields."""</span>
    <span class="n">field</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">'docValueLess'</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">value</span><span class="p">)):</span>
            <span class="k">yield</span> <span class="n">document</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docvalues</span><span class="p">:</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">docValueClass</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.NestedField.prefix">
<code class="highlight language-python">
prefix<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return prefix query of the closest possible prefixed field.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return prefix query of the closest possible prefixed field."""</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">prefix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.NestedField.range">
<code class="highlight language-python">
range<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return range query of the closest possible prefixed field.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return range query of the closest possible prefixed field."""</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.NestedField.values">
<code class="highlight language-python">
values<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate component field values in order.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">"""Generate component field values in order."""</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">[:</span><span class="n">index</span><span class="p">])</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.DateTimeField">
<code>lupyne.engine.documents.DateTimeField</code>
</h3>
<div class="doc doc-contents first">
<p>Field which indexes datetimes as Point fields of timestamps.</p>
<p>Supports datetimes, dates, and any prefix of time tuples.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.DateTimeField.duration">
<code class="highlight language-python">
duration<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">delta</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return date range query within time span of date.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>date</code></td>
<td><code></code></td>
<td>
<p>origin date or tuple</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>days,delta</code></td>
<td><code></code></td>
<td>
<p>timedelta parameters</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">delta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return date range query within time span of date.</span>

<span class="sd">    Args:</span>
<span class="sd">        date: origin date or tuple</span>
<span class="sd">        days,delta: timedelta parameters</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="nb">len</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="p">:]))</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="o">**</span><span class="n">delta</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">*</span><span class="nb">sorted</span><span class="p">([</span><span class="n">date</span><span class="p">,</span> <span class="n">date</span> <span class="o">+</span> <span class="n">delta</span><span class="p">]),</span> <span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.DateTimeField.items">
<code class="highlight language-python">
items<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">dates</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate lucene NumericFields of timestamps.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">dates</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">document</span><span class="o">.</span><span class="n">Field</span><span class="p">]:</span>
    <span class="sd">"""Generate lucene NumericFields of timestamps."""</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">dates</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.DateTimeField.prefix">
<code class="highlight language-python">
prefix<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return range query which matches the date prefix.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return range query which matches the date prefix."""</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()[:</span> <span class="mi">6</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span> <span class="k">else</span> <span class="mi">3</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">date</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>  <span class="c1"># month must be valid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">date</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.DateTimeField.range">
<code class="highlight language-python">
range<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="o">**</span><span class="n">inclusive</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return NumericRangeQuery of timestamps.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="o">**</span><span class="n">inclusive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return NumericRangeQuery of timestamps."""</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="p">(</span><span class="n">date</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">ranges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="o">**</span><span class="n">inclusive</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.DateTimeField.timestamp">
<code class="highlight language-python">
timestamp<span class="p">(</span><span class="n">date</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return utc timestamp from date or time tuple.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">timestamp</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">"""Return utc timestamp from date or time tuple."""</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">timetuple</span><span class="p">())</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">'microsecond'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-6</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="nb">len</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="p">:]))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.DateTimeField.within">
<code class="highlight language-python">
within<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weeks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">delta</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return date range query within current time and delta.</p>
<p>If the delta is an exact number of days, then dates will be used.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>days,weeks</code></td>
<td><code></code></td>
<td>
<p>number of days to offset from today</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>utc</code></td>
<td><code></code></td>
<td>
<p>optionally use utc instead of local time</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>delta</code></td>
<td><code></code></td>
<td>
<p>additional timedelta parameters</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weeks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">delta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return date range query within current time and delta.</span>

<span class="sd">    If the delta is an exact number of days, then dates will be used.</span>

<span class="sd">    Args:</span>
<span class="sd">        days,weeks: number of days to offset from today</span>
<span class="sd">        utc: optionally use utc instead of local time</span>
<span class="sd">        delta: additional timedelta parameters</span>
<span class="sd">    """</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="k">if</span> <span class="n">utc</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">days</span> <span class="o">+</span> <span class="n">weeks</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="n">delta</span><span class="p">):</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">weeks</span><span class="o">=</span><span class="n">weeks</span><span class="p">,</span> <span class="o">**</span><span class="n">delta</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.documents.SpatialField">
<code>lupyne.engine.documents.SpatialField</code>
</h3>
<div class="doc doc-contents first">
<p>Geospatial points, indexed with optional docvalues.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.SpatialField.distances">
<code class="highlight language-python">
distances<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return distance SortField.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">distances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lng</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return distance SortField."""</span>
    <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">LatLonDocValuesField</span><span class="o">.</span><span class="n">newDistanceSort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.SpatialField.items">
<code class="highlight language-python">
items<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">points</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Generate lucene LatLon fields from points (lng, lat).</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">points</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">document</span><span class="o">.</span><span class="n">Field</span><span class="p">]:</span>
    <span class="sd">"""Generate lucene LatLon fields from points (lng, lat)."""</span>
    <span class="k">for</span> <span class="n">lng</span><span class="p">,</span> <span class="n">lat</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">document</span><span class="o">.</span><span class="n">LatLonPoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docvalues</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">lng</span><span class="p">,</span> <span class="n">lat</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">document</span><span class="o">.</span><span class="n">LatLonDocValuesField</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.documents.SpatialField.within">
<code class="highlight language-python">
within<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return range queries for any tiles which could be within distance of given point.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lng,lat</code></td>
<td><code></code></td>
<td>
<p>point</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>distance</code></td>
<td><code>float</code></td>
<td>
<p>search radius in meters</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>lupyne/engine/documents.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lng</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return range queries for any tiles which could be within distance of given point.</span>

<span class="sd">    Args:</span>
<span class="sd">        lng,lat: point</span>
<span class="sd">        distance: search radius in meters</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">LatLonPoint</span><span class="o">.</span><span class="n">newDistanceQuery</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="queries">queries</h2>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.queries.Query">
<code>lupyne.engine.queries.Query</code>
</h3>
<div class="doc doc-contents first">
<p>Inherited lucene Query, with dynamic base class acquisition.</p>
<p>Uses class methods and operator overloading for convenient query construction.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.__and__">
<code class="highlight language-python">
__and__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>+self +other</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""+self +other"""</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.__neg__">
<code class="highlight language-python">
__neg__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>-self</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""-self"""</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">BooleanClause</span><span class="o">.</span><span class="n">Occur</span><span class="o">.</span><span class="n">MUST_NOT</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.__new__">
<code class="highlight language-python">
__new__<span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Create and return a new object.  See help(type) for accurate signature.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">base</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base</span><span class="p">),</span> <span class="p">{}))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.__or__">
<code class="highlight language-python">
__or__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>self other</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""self other"""</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.__pos__">
<code class="highlight language-python">
__pos__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>+self</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""+self"""</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.__sub__">
<code class="highlight language-python">
__sub__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>self -other</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""self -other"""</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">BooleanQuery</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span>
    <span class="n">builder</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="o">.</span><span class="n">BooleanClause</span><span class="o">.</span><span class="n">Occur</span><span class="o">.</span><span class="n">SHOULD</span><span class="p">)</span>
    <span class="n">builder</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">search</span><span class="o">.</span><span class="n">BooleanClause</span><span class="o">.</span><span class="n">Occur</span><span class="o">.</span><span class="n">MUST_NOT</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.all">
<code class="highlight language-python">
all<span class="p">(</span><span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene BooleanQuery with MUST clauses from queries and terms.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene BooleanQuery with MUST clauses from queries and terms."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">BooleanClause</span><span class="o">.</span><span class="n">Occur</span><span class="o">.</span><span class="n">MUST</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.alldocs">
<code class="highlight language-python">
alldocs<span class="p">()</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene MatchAllDocsQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">alldocs</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene MatchAllDocsQuery."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">MatchAllDocsQuery</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.any">
<code class="highlight language-python">
any<span class="p">(</span><span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene BooleanQuery with SHOULD clauses from queries and terms.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene BooleanQuery with SHOULD clauses from queries and terms."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">BooleanClause</span><span class="o">.</span><span class="n">Occur</span><span class="o">.</span><span class="n">SHOULD</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.boost">
<code class="highlight language-python">
boost<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene BoostQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">boost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene BoostQuery."""</span>
    <span class="k">return</span> <span class="n">Query</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">BoostQuery</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.constant">
<code class="highlight language-python">
constant<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene ConstantScoreQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">constant</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene ConstantScoreQuery."""</span>
    <span class="k">return</span> <span class="n">Query</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">ConstantScoreQuery</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.disjunct">
<code class="highlight language-python">
disjunct<span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene DisjunctionMaxQuery from queries and terms.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">disjunct</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">):</span>
    <span class="sd">"""Return lucene DisjunctionMaxQuery from queries and terms."""</span>
    <span class="n">queries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">queries</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">([</span><span class="n">values</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">values</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">DisjunctionMaxQuery</span><span class="p">,</span> <span class="n">Arrays</span><span class="o">.</span><span class="n">asList</span><span class="p">(</span><span class="n">queries</span><span class="p">),</span> <span class="n">multiplier</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.filter">
<code class="highlight language-python">
filter<span class="p">(</span><span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene BooleanQuery with FILTER clauses from queries and terms.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene BooleanQuery with FILTER clauses from queries and terms."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">BooleanClause</span><span class="o">.</span><span class="n">Occur</span><span class="o">.</span><span class="n">FILTER</span><span class="p">,</span> <span class="o">*</span><span class="n">queries</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.fuzzy">
<code class="highlight language-python">
fuzzy<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene FuzzyQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fuzzy</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene FuzzyQuery."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">FuzzyQuery</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.near">
<code class="highlight language-python">
near<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return <a href="#lupyne.engine.queries.SpanQuery.near">SpanNearQuery</a> from terms.
Term values which supply another field name will be masked.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">near</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'SpanQuery'</span><span class="p">:</span>
    <span class="sd">"""Return [SpanNearQuery][lupyne.engine.queries.SpanQuery.near] from terms.</span>
<span class="sd">    Term values which supply another field name will be masked."""</span>
    <span class="n">spans</span> <span class="o">=</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="bp">cls</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="o">*</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SpanQuery</span><span class="o">.</span><span class="n">near</span><span class="p">(</span><span class="o">*</span><span class="n">spans</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.nodocs">
<code class="highlight language-python">
nodocs<span class="p">()</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene MatchNoDocsQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">nodocs</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene MatchNoDocsQuery."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">MatchNoDocsQuery</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.phrase">
<code class="highlight language-python">
phrase<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene MultiPhraseQuery.  None may be used as a placeholder.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">phrase</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene MultiPhraseQuery.  None may be used as a placeholder."""</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">MultiPhraseQuery</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">builder</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">words</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">words</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">builder</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.points">
<code class="highlight language-python">
points<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene set query of one dimensional points.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return lucene set query of one dimensional points."""</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">DoublePoint</span><span class="o">.</span><span class="n">newSetQuery</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">LongPoint</span><span class="o">.</span><span class="n">newSetQuery</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">values</span><span class="p">)))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.prefix">
<code class="highlight language-python">
prefix<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene PrefixQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">prefix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene PrefixQuery."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">PrefixQuery</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.range">
<code class="highlight language-python">
range<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene RangeQuery, by default with a half-open interval.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene RangeQuery, by default with a half-open interval."""</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">TermRangeQuery</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.ranges">
<code class="highlight language-python">
ranges<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">intervals</span><span class="p">,</span> <span class="o">**</span><span class="n">inclusive</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene multidimensional point range query, by default with half-open intervals.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">ranges</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">intervals</span><span class="p">,</span> <span class="o">**</span><span class="n">inclusive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return lucene multidimensional point range query, by default with half-open intervals."""</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">inclusive</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'lower'</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="n">inclusive</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'upper'</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">starts</span><span class="p">,</span> <span class="n">stops</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">Double</span><span class="o">.</span><span class="n">NEGATIVE_INFINITY</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">lower</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">DoublePoint</span><span class="o">.</span><span class="n">nextUp</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">Double</span><span class="o">.</span><span class="n">POSITIVE_INFINITY</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">upper</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">DoublePoint</span><span class="o">.</span><span class="n">nextDown</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="n">MIN_VALUE</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">lower</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="n">MAX_VALUE</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">upper</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
        <span class="n">starts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">stops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">starts</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">DoublePoint</span><span class="o">.</span><span class="n">newRangeQuery</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">starts</span><span class="p">,</span> <span class="n">stops</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">LongPoint</span><span class="o">.</span><span class="n">newRangeQuery</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">starts</span><span class="p">,</span> <span class="n">stops</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.regexp">
<code class="highlight language-python">
regexp<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene RegexpQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">regexp</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene RegexpQuery."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">RegexpQuery</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.span">
<code class="highlight language-python">
span<span class="p">(</span><span class="o">*</span><span class="n">term</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return <a href="#lupyne.engine.queries.SpanQuery">SpanQuery</a> from term name and value or a MultiTermQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">span</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">term</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'SpanQuery'</span><span class="p">:</span>
    <span class="sd">"""Return [SpanQuery][lupyne.engine.queries.SpanQuery] from term name and value or a MultiTermQuery."""</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">term</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SpanQuery</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">SpanMultiTermQueryWrapper</span><span class="p">,</span> <span class="o">*</span><span class="n">term</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SpanQuery</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">SpanTermQuery</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="o">*</span><span class="n">term</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.term">
<code class="highlight language-python">
term<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene TermQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">term</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene TermQuery."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">TermQuery</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.terms">
<code class="highlight language-python">
terms<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene TermInSetQuery, optimizing a SHOULD BooleanQuery of many terms.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">terms</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene TermInSetQuery, optimizing a SHOULD BooleanQuery of many terms."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">TermInSetQuery</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">BytesRef</span><span class="p">,</span> <span class="n">values</span><span class="p">)))</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.Query.wildcard">
<code class="highlight language-python">
wildcard<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
</span>
</h4>
<div class="doc doc-contents">
<p>Return lucene WildcardQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">wildcard</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'Query'</span><span class="p">:</span>
    <span class="sd">"""Return lucene WildcardQuery."""</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">WildcardQuery</span><span class="p">,</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.queries.SpanQuery">
<code>lupyne.engine.queries.SpanQuery</code>
</h3>
<div class="doc doc-contents first">
<p>Inherited lucene SpanQuery with additional span constructors.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.SpanQuery.boost">
<code class="highlight language-python">
boost<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene SpanBoostQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">boost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'SpanQuery'</span><span class="p">:</span>
    <span class="sd">"""Return lucene SpanBoostQuery."""</span>
    <span class="k">return</span> <span class="n">SpanQuery</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">SpanBoostQuery</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.SpanQuery.containing">
<code class="highlight language-python">
containing<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene SpanContainingQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">containing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">spans</span><span class="o">.</span><span class="n">SpanQuery</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'SpanQuery'</span><span class="p">:</span>
    <span class="sd">"""Return lucene SpanContainingQuery."""</span>
    <span class="k">return</span> <span class="n">SpanQuery</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">SpanContainingQuery</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.SpanQuery.mask">
<code class="highlight language-python">
mask<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene FieldMaskingSpanQuery, which allows combining span queries from different fields.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'SpanQuery'</span><span class="p">:</span>
    <span class="sd">"""Return lucene FieldMaskingSpanQuery, which allows combining span queries from different fields."""</span>
    <span class="k">return</span> <span class="n">SpanQuery</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">FieldMaskingSpanQuery</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.SpanQuery.near">
<code class="highlight language-python">
near<span class="p">(</span><span class="o">*</span><span class="n">spans_</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">slop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inOrder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene SpanNearQuery from SpanQueries.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">near</span><span class="p">(</span><span class="o">*</span><span class="n">spans_</span><span class="p">,</span> <span class="n">slop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inOrder</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""Return lucene SpanNearQuery from SpanQueries."""</span>
    <span class="k">return</span> <span class="n">SpanQuery</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">SpanNearQuery</span><span class="p">,</span> <span class="n">spans_</span><span class="p">,</span> <span class="n">slop</span><span class="p">,</span> <span class="n">inOrder</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.SpanQuery.within">
<code class="highlight language-python">
within<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return lucene SpanWithinQuery.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">spans</span><span class="o">.</span><span class="n">SpanQuery</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'SpanQuery'</span><span class="p">:</span>
    <span class="sd">"""Return lucene SpanWithinQuery."""</span>
    <span class="k">return</span> <span class="n">SpanQuery</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">SpanWithinQuery</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="lupyne.engine.queries.SpellParser">
<code>lupyne.engine.queries.SpellParser</code>
</h3>
<div class="doc doc-contents first">
<p>Inherited lucene QueryParser which corrects spelling.</p>
<p>Assign a searcher attribute or override <a href="#lupyne.engine.queries.SpellParser.suggest">suggest</a> implementation.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.SpellParser.rewrite">
<code class="highlight language-python">
rewrite<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return term or phrase query with corrected terms substituted.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">rewrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">search</span><span class="o">.</span><span class="n">Query</span><span class="p">:</span>
    <span class="sd">"""Return term or phrase query with corrected terms substituted."""</span>
    <span class="k">if</span> <span class="n">search</span><span class="o">.</span><span class="n">TermQuery</span><span class="o">.</span><span class="n">instance_</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">TermQuery</span><span class="o">.</span><span class="n">cast_</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">term</span>
        <span class="k">return</span> <span class="n">search</span><span class="o">.</span><span class="n">TermQuery</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suggest</span><span class="p">(</span><span class="n">term</span><span class="p">))</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">PhraseQuery</span><span class="o">.</span><span class="n">cast_</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">builder</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">PhraseQuery</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">query</span><span class="o">.</span><span class="n">terms</span><span class="p">):</span>
        <span class="n">builder</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suggest</span><span class="p">(</span><span class="n">term</span><span class="p">),</span> <span class="n">position</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="lupyne.engine.queries.SpellParser.suggest">
<code class="highlight language-python">
suggest<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span> </code>
</h4>
<div class="doc doc-contents">
<p>Return term with text replaced as necessary.</p>
<details class="quote">
<summary>Source code in <code>lupyne/engine/queries.py</code></summary>
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">suggest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">:</span>
    <span class="sd">"""Return term with text replaced as necessary."""</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
    <span class="n">words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searcher</span><span class="o">.</span><span class="n">suggest</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">term</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">index</span><span class="o">.</span><span class="n">Term</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="o">*</span><span class="n">words</span><span class="p">)</span> <span class="k">if</span> <span class="n">words</span> <span class="k">else</span> <span class="n">term</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href=".." rel="prev">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../services/" rel="next">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Services
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/vendor.fd16492e.min.js"></script>
<script src="../assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
<script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>